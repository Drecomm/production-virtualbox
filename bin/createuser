#!/bin/bash

function randompass () {
  pass=</dev/urandom tr -dc A-Za-z0-9 | head -c 16
  echo $pass
}
PASSWORD=`randompass`

echo "Enter username"
read USERNAME

if [ $USERNAME != "" ]; then
  /usr/sbin/useradd -p \`openssl passwd -1 $PASSWORD\` -k /etc/skel -s /bin/bash -d /home/$USERNAME $USERNAME
  sed -i "s/USERNAME/$USERNAME/" /home/$USERNAME/conf/php-fpm.conf.dist
  echo "Enable PHP-FPM?"
  read FPM
  if [ $FPM == "1" ]; then
    mv /home/$USERNAME/conf/php-fpm.conf.dist /home/$USERNAME/conf/php-fpm.conf
  fi
fi
